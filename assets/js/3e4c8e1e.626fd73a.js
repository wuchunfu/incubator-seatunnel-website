"use strict";(self.webpackChunkseatunnel_website=self.webpackChunkseatunnel_website||[]).push([[4151],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),s=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,h=d["".concat(c,".").concat(m)]||d[m]||u[m]||a;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4594:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return s},assets:function(){return p},toc:function(){return u},default:function(){return m}});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),i=["components"],l={slug:"Upcoming API Connector Development Analysis",title:"Upcoming API Connector Development Analysis",tags:["Meetup"]},c="Apache SeaTunnel:  Upcoming API Connector Development Analysis",s={permalink:"/blog/Upcoming API Connector Development Analysis",editUrl:"https://github.com/apache/incubator-seatunnel-website/edit/main/blog/2022-06-23-New_Connector.md",source:"@site/blog/2022-06-23-New_Connector.md",title:"Upcoming API Connector Development Analysis",description:"After days of community development, the preliminary development of the new Connector API of SeaTunnel is completed. The next step is to adapt this new connector. In order to aid the developers to use this connector, this article provides guide to develop a new API.",date:"2022-06-23T00:00:00.000Z",formattedDate:"June 23, 2022",tags:[{label:"Meetup",permalink:"/blog/tags/meetup"}],readingTime:3.28,truncated:!1,authors:[],frontMatter:{slug:"Upcoming API Connector Development Analysis",title:"Upcoming API Connector Development Analysis",tags:["Meetup"]},nextItem:{title:"How dose Apache SeaTunnel refactor the API to decouple with the computing engine",permalink:"/blog/How dose Apache SeaTunnel refactor the API to decouple with the computing engine"}},p={authorsImageUrls:[]},u=[{value:"Priliminary Setup",id:"priliminary-setup",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Connector Testing",id:"connector-testing",level:2},{value:"Submit PR",id:"submit-pr",level:2}],d={toc:u};function m(e){var t=e.components,l=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"After days of community development, the preliminary development of the new Connector API of SeaTunnel is completed. The next step is to adapt this new connector. In order to aid the developers to use this connector, this article provides guide to develop a new API."),(0,a.kt)("h2",{id:"priliminary-setup"},"Priliminary Setup"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Environment configuration: JDK8 and Scala2.11 are recommended.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"As before, we need to download the latest code locally through git and import it into the IDE, project address: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/incubator-seatunnel"},"https://github.com/apache/incubator-seatunnel")," . At the same time, switch the branch to api-draft, and currently use this branch to develop the new version of the API and the corresponding Connector. The project structure is as follows:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{loading:"lazy",alt:"Project Structure",src:n(77849).Z,width:"583",height:"1014"})))),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"At present, in order to distinguish different Connectors, we put the connectors that support"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Flink/Spark under the ",(0,a.kt)("inlineCode",{parentName:"li"},"seatunnel-connectors/seatunnel-connectors-flink(spark)")," module."),(0,a.kt)("li",{parentName:"ul"},"New version of the Connector is placed under the ",(0,a.kt)("inlineCode",{parentName:"li"},"seatunnel-connectors/seatunnel-connectors-seatunnel")," module.")),(0,a.kt)("p",{parentName:"li"},"As we can see from the above figure, we have implemented Fake, Console, Kafka Connector, and Clickhouse Connector is also being implemented.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"At present, the data type we support is SeaTunnelRow, so no matter the type of data generated by the Source or the type of data consumed by the Sink, it should be SeaTunnelRow."))),(0,a.kt)("h1",{id:"development-of-connector"},"Development of Connector"),(0,a.kt)("p",null,"Taking Fake Connector as an example, let's introduce how to implement a new Connector:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Create a corresponding module with a path under ",(0,a.kt)("inlineCode",{parentName:"p"},"seatunnel-connectors-seatunnel"),", which is at the same level as other new connectors.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Modify the ",(0,a.kt)("inlineCode",{parentName:"p"},"seatunnel-connectors-seatunnel/pom.xml")," file, add a new module to modules, modify ",(0,a.kt)("inlineCode",{parentName:"p"},"seatunnel-connectors-seatunnel/seatunnel-connector-seatunnel-fake/pom.xml"),", add seatunnel-api dependencies, and correct parent Quote. The resulting style is as follows:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{loading:"lazy",alt:"Style",src:n(59310).Z,width:"949",height:"568"}))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The next step is to create the corresponding package and related classes, create FakeSource, and need to inherit SeaTunnel Source."),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Note : The Source of SeaTunnel adopts the design of stream and batch integration. The Source of SeaTunnel determines whether current Source is a stream or batch through attribute getBoundedness.")),(0,a.kt)("p",{parentName:"li"},"So you can specify a Source as a stream or batch by dynamic configuration (refer to the default method). The configuration defined by the user in the configuration file can be obtained through the prepare method to realize the customized configuration."),(0,a.kt)("p",{parentName:"li"},"Then create FakeSourceReader, FakeSource SplitEnumerator, and FakeSourceSplit to inherit the corresponding abstract classes (which can be found in the corresponding classes). As long as we implement the corresponding methods of these classes, then our SeaTunnel Source Connector is basically completed.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Next, just follow the existing example to write the corresponding code. The most important one is the FakeSource Reader, which defines how we obtain data from the outside, which is the most critical part of the Source Connector. Every time a piece of data is generated, we need to place it in the collector as shown:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{loading:"lazy",alt:"Source",src:n(32778).Z,width:"935",height:"424"}))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"After the code development is complete, we need to configure the configuration file ",(0,a.kt)("inlineCode",{parentName:"p"},"plugin-mapping.properties")," located under ",(0,a.kt)("inlineCode",{parentName:"p"},"seatunnel-connectors/modules"),". Adding a seatunnel\n",(0,a.kt)("inlineCode",{parentName:"p"},".source.FakeSource = seatunnel-connector-fake"),"\nmeans that SeaTunnel can find the jar package corresponding to the project by looking for a Source named FakeSource. This allows the Connector to be used in the normal configuration file.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"For a detailed description of writing Source and Sink and SeaTunnel API, please refer to the introduction at ",(0,a.kt)("inlineCode",{parentName:"p"},"seatunnel-connectors/seatunnel-connectors-seatunnel/ README.zh.md"),"."))),(0,a.kt)("h2",{id:"connector-testing"},"Connector Testing"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"For testing, we can find the ",(0,a.kt)("inlineCode",{parentName:"li"},"seatunnel-flink(spark)-new-connector-example")," module in seatunnel-examples, and test it against different engines to ensure that the performance of the Connector is as consistent as possible. If you find any discrepancies, you can mark them in the document, modify the configuration file under resource, add our Connector to the configuration, and introduce ",(0,a.kt)("inlineCode",{parentName:"li"},"seatunnel-flink(spark)-new-connector-example/pom.xml")," dependency, you can execute ",(0,a.kt)("inlineCode",{parentName:"li"},"SeaTunnelApiExample")," to test."),(0,a.kt)("li",{parentName:"ul"},"The default is stream processing mode, and the execution mode is switched to batch mode by modifying ",(0,a.kt)("inlineCode",{parentName:"li"},"job.mode=BATCH")," in the environment of the configuration file.")),(0,a.kt)("h2",{id:"submit-pr"},"Submit PR"),(0,a.kt)("p",null,"When our Connector is ready, we can submit PR to github. After reviewing by other partners, our contributed Connector will become part of SeaTunnel!"))}m.isMDXComponent=!0},77849:function(e,t,n){t.Z=n.p+"assets/images/0-82b23e9c80c8b70ce10feaccfc96a2a6.png"},59310:function(e,t,n){t.Z=n.p+"assets/images/1-27a269d360e9ee05b1dd696eeb0aa8e4.png"},32778:function(e,t,n){t.Z=n.p+"assets/images/2-6e56482ef5f497868040295fe7edff23.png"}}]);